{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "CVE Aliases (Infamous Vulnerabilities & Attacks)",
  "$id": "https://raw.githubusercontent.com/giterlizzi/secdb-feeds/main/cve-aliases-schema.json",
  "type": "object",
  "$defs": {
    "cve_t": {
      "title": "CVE number",
      "type": "string",
      "pattern": "^CVE-[0-9]{4}-[0-9]{4,}$"
    },
    "aliases_t": {
      "title": "List of CVE aliases",
      "type": "array",
      "minItems": 1,
      "items": {
        "$ref": "#/$defs/alias_t"
      }
    },
    "alias_t": {
      "type": "object",
      "required": [
        "name",
        "cves"
      ],
      "properties": {
        "name": {
          "title": "Vulnerability or attack name",
          "type": "string"
        },
        "cves": {
          "type": "array",
          "minItems": 1,
          "items": {
            "$ref": "#/$defs/cve_t"
          }
        },
        "references": {
          "title": "References",
          "$ref": "#/$defs/references_t"
        }
      }
    },
    "references_t": {
      "title": "List of references",
      "type": "array",
      "minItems": 1,
      "items": {
        "$ref": "#/$defs/reference_t"
      }
    },
    "reference_t": {
      "title": "Vulnerability / Attack reference",
      "type": "object",
      "properties": {
        "url": {
          "title": "Reference URL",
          "type": "string",
          "format": "uri"
        },
        "name": {
          "title": "Reference name",
          "type": "string"
        },
        "source": {
          "title": "Reference source",
          "type": "string"
        }
      },
      "required": [
        "url"
      ]
    }
  },
  "properties": {
    "metadata": {
      "title": "Metadata",
      "type": "object",
      "properties": {
        "timestamp": {
          "title": "Timestamp",
          "type": "string"
        }
      }
    },
    "aliases": {
      "title": "CVE aliases",
      "$ref": "#/$defs/aliases_t"
    }
  },
  "required": [
    "metadata",
    "aliases"
  ]
}
